!function(a){function b(a,b){for(var c=a;c;){if(c.contains(b)||c==b)return c;c=c.parentNode}return null}function c(a,b,c){var d=i.createEvent("HTMLEvents");if(d.initEvent(b,!0,!0),"object"==typeof c)for(var e in c)d[e]=c[e];a.dispatchEvent(d)}function d(a,b,c,d,e,f,g,h){var i=Math.atan2(h-f,g-e)-Math.atan2(d-b,c-a),j=Math.sqrt((Math.pow(h-f,2)+Math.pow(g-e,2))/(Math.pow(d-b,2)+Math.pow(c-a,2))),k=[e-j*a*Math.cos(i)+j*b*Math.sin(i),f-j*b*Math.cos(i)-j*a*Math.sin(i)];return{rotate:i,scale:j,translate:k,matrix:[[j*Math.cos(i),-j*Math.sin(i),k[0]],[j*Math.sin(i),j*Math.cos(i),k[1]],[0,0,1]]}}function e(a){0===Object.keys(l).length&&(j.addEventListener("touchmove",f,!1),j.addEventListener("touchend",g,!1),j.addEventListener("touchcancel",h,!1));for(var d=0;d<a.changedTouches.length;d++){var e=a.changedTouches[d],i={};for(var m in e)i[m]=e[m];var n={startTouch:i,startTime:Date.now(),status:"tapping",element:a.srcElement,pressingHandler:setTimeout(function(b){return function(){"tapping"===n.status&&(n.status="pressing",c(b,"press",{touchEvent:a})),clearTimeout(n.pressingHandler),n.pressingHandler=null}}(a.srcElement),500)};l[e.identifier]=n}if(2==Object.keys(l).length){var o=[];for(var m in l)o.push(l[m].element);c(b(o[0],o[1]),"dualtouchstart",{touches:k.call(a.touches),touchEvent:a})}}function f(a){for(var e=0;e<a.changedTouches.length;e++){var f=a.changedTouches[e],g=l[f.identifier];if(!g)return;var h=f.clientX-g.startTouch.clientX,i=f.clientY-g.startTouch.clientY,j=Math.sqrt(Math.pow(h,2)+Math.pow(i,2));"tapping"===g.status&&j>10&&(g.status="panning",c(g.element,"panstart",{touch:f,touchEvent:a}),Math.abs(h)>Math.abs(i)?(c(g.element,"horizontalpanstart",{touch:f,touchEvent:a}),g.isVertical=!1):(c(g.element,"verticalpanstart",{touch:f,touchEvent:a}),g.isVertical=!0)),"panning"===g.status&&(g.panTime=Date.now(),c(g.element,"pan",{displacementX:h,displacementY:i,touch:f,touchEvent:a}),g.isVertical?c(g.element,"verticalpan",{displacementY:i,touch:f,touchEvent:a}):c(g.element,"horizontalpan",{displacementX:h,touch:f,touchEvent:a}))}if(2==Object.keys(l).length){for(var k,m=[],n=[],o=[],e=0;e<a.touches.length;e++){var f=a.touches[e],g=l[f.identifier];m.push([g.startTouch.clientX,g.startTouch.clientY]),n.push([f.clientX,f.clientY])}for(var p in l)o.push(l[p].element);k=d(m[0][0],m[0][1],m[1][0],m[1][1],n[0][0],n[0][1],n[1][0],n[1][1]),c(b(o[0],o[1]),"dualtouch",{transform:k,touches:a.touches,touchEvent:a})}}function g(a){if(2==Object.keys(l).length){var d=[];for(var e in l)d.push(l[e].element);c(b(d[0],d[1]),"dualtouchend",{touches:k.call(a.touches),touchEvent:a})}for(var i=0;i<a.changedTouches.length;i++){var n=a.changedTouches[i],o=n.identifier,p=l[o];if(p){if(p.pressingHandler&&(clearTimeout(p.pressingHandler),p.pressingHandler=null),"tapping"===p.status&&(p.timestamp=Date.now(),c(p.element,"tap",{touch:n,touchEvent:a}),m&&p.timestamp-m.timestamp<300&&c(p.element,"doubletap",{touch:n,touchEvent:a}),this.lastTap=p),"panning"===p.status){var q=Date.now()-p.startTime,r=(n.clientX-p.startTouch.clientX)/q,s=(n.clientY-p.startTouch.clientY)/q,t=n.clientX-p.startTouch.clientX,u=n.clientY-p.startTouch.clientY;c(p.element,"panend",{isflick:300>q,touch:n,touchEvent:a}),300>q&&(c(p.element,"flick",{duration:q,velocityX:r,velocityY:s,displacementX:t,displacementY:u,touch:n,touchEvent:a}),p.isVertical?c(p.element,"verticalflick",{duration:q,velocityY:s,displacementY:u,touch:n,touchEvent:a}):c(p.element,"horizontalflick",{duration:q,velocityX:r,displacementX:t,touch:n,touchEvent:a}))}"pressing"===p.status&&c(p.element,"pressend",{touch:n,touchEvent:a}),delete l[o]}}0===Object.keys(l).length&&(j.removeEventListener("touchmove",f,!1),j.removeEventListener("touchend",g,!1),j.removeEventListener("touchcancel",h,!1))}function h(a){if(2==Object.keys(l).length){var d=[];for(var e in l)d.push(l[e].element);c(b(d[0],d[1]),"dualtouchend",{touches:k.call(a.touches),touchEvent:a})}for(var i=0;i<a.changedTouches.length;i++){var m=a.changedTouches[i],n=m.identifier,o=l[n];o&&(o.pressingHandler&&(clearTimeout(o.pressingHandler),o.pressingHandler=null),"panning"===o.status&&c(o.element,"panend",{touch:m,touchEvent:a}),"pressing"===o.status&&c(o.element,"pressend",{touch:m,touchEvent:a}),delete l[n])}0===Object.keys(l).length&&(j.removeEventListener("touchmove",f,!1),j.removeEventListener("touchend",g,!1),j.removeEventListener("touchcancel",h,!1))}var i=a.document,j=i.documentElement,k=Array.prototype.slice,l={},m=null;j.addEventListener("touchstart",e,!1)}(window,window.lib||(window.lib={}));